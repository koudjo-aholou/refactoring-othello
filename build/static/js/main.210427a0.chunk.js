(this.webpackJsonpclient=this.webpackJsonpclient||[]).push([[0],{107:function(e,t){},114:function(e,t,n){"use strict";n.r(t);var a=n(0),r=n.n(a),c=n(51),o=n.n(c),u=(n(61),n(3)),l=n.n(u),i=n(1),s=n(17),m=n(13),d={state:"empty"},f=["A","B","C","D","E","F","G","H"],p=[0,1,2,3,4,5,6,7],b=function(){var e=p.map((function(e){return p.map((function(t){return Object(s.a)({},d,{rowIndex:e,columnIndex:t,name:f[e]+(t+1)})}))}));return e[3][3].state="white",e[3][4].state="black",e[4][3].state="black",e[4][4].state="white",e},h=[function(e,t,n){return n[e-1][t-1]},function(e,t,n){return n[e+1][t-1]},function(e,t,n){return n[e-1][t+1]},function(e,t,n){return n[e+1][t+1]},function(e,t,n){return n[e][t+1]},function(e,t,n){return n[e][t-1]},function(e,t,n){return n[e-1][t]},function(e,t,n){return n[e+1][t]}],v=function(e,t){var n=[];return t.map((function(t){return t.map((function(t){return t.state===e?n.push(t):null}))})),n},w=function(e,t){var n=[];return v("black"===e?"white":"black",t).map((function(n){return function(e,t,n){var a=e.rowIndex,r=e.columnIndex,c=[];return h.map((function(e){try{var o=e(a,r,n);if(o&&o.state===t){for(;o&&o.state===t;)o=e(o.rowIndex,o.columnIndex,n);o&&"empty"===o.state&&c.push(o)}}catch(u){}})),c}(n,e,t)})).map((function(e){return e.map((function(e){return n.push(e)}))})),n.map((function(e){return e.state="playable",e}))},E=function(e){return v("playable",e).map((function(e){return e.state="empty",e}))},g=n(5),j=n.n(g),O="http://localhost:5000/api/boards",x=null,y=function(){var e;return l.a.async((function(t){for(;;)switch(t.prev=t.next){case 0:return e=j.a.get(O),t.abrupt("return",e.then((function(e){return e.data})));case 2:case"end":return t.stop()}}))},k=function(e){var t={headers:{Authorization:x}};return console.log("newObject",e),j.a.post(O,e,t).then((function(e){return e.data}))},I=function(e,t){var n={headers:{Authorization:x}};return console.log("newObject",t),j.a.put("".concat(O,"/").concat(e),t,n).then((function(e){return e.data}))},S=function(e){x="bearer ".concat(e)},N="http://localhost:5000/api/users",C=function(e){return j.a.post(N,e).then((function(e){return e.data}))},B=function(e,t){return j.a.put("".concat(N,"/").concat(e),t).then((function(e){return e.data}))},R=function(e){return"playable"===e.state?r.a.createElement("div",{className:"reversi-tile"},r.a.createElement("div",{className:e.state,name:e.name,onClick:function(){return e.handlePlayTurn(e.rowIndex,e.columnIndex)}})):r.a.createElement("div",{className:"reversi-tile"},r.a.createElement("div",{className:e.state,name:e.name}))},L=function(e){var t=e.board,n=e.socket,c=Object(a.useState)(""),o=Object(i.a)(c,2),u=o[0],d=o[1],f=Object(a.useState)([]),p=Object(i.a)(f,2),g=p[0],j=p[1],O=Object(a.useState)(""),x=Object(i.a)(O,2),k=x[0],N=x[1],C=Object(a.useState)(v("black",g).length),B=Object(i.a)(C,2),L=B[0],P=B[1],G=Object(a.useState)(v("white",g).length),J=Object(i.a)(G,2),z=J[0],F=J[1],T=Object(a.useState)(!1),A=Object(i.a)(T,2),M=A[0],W=A[1],D=Object(a.useState)([]),H=Object(i.a)(D,2),q=(H[0],H[1]),U=Object(a.useState)(!1),V=Object(i.a)(U,2),$=V[0],K=V[1],Q=Object(a.useState)(""),X=Object(i.a)(Q,2),Y=X[0],Z=X[1],_=Object(a.useState)(0),ee=Object(i.a)(_,2),te=ee[0],ne=ee[1];if(Object(a.useEffect)((function(){y().then((function(e){if(t){var n=e.find((function(e){return e.id===t.id}));if(N(n.turn),q(n.users),P(n.blackscore),F(n.whitescore),"black"===n.turn&&u.id===n.users[0].id){var a=Object(m.a)(n.board);w("white",a).map((function(e){a[e.rowIndex][e.columnIndex]=e})),j(a)}else j(n.board);if("white"===n.turn&&u.id===n.users[1].id){var r=Object(m.a)(n.board);w("black",r).map((function(e){r[e.rowIndex][e.columnIndex]=e})),j(r)}else j(n.board);if(v("empty",n.board).length+v("playable",n.board).length<1)return K(!1),W(!0)}})),d(JSON.parse(localStorage.getItem("user"))),n.on("play",(function(e){j(e.board),P(e.blackscore),F(e.whitescore),N(e.turn),Z("L'adversaire vient de jouer un coup !")}))}),[t,L]),M){var ae=Object(m.a)(g);E(ae).map((function(e){ae[e.rowIndex][e.columnIndex]=e})),I(t.id,Object(s.a)({},g,{board:ae,active:!1}))}v("playable",g)&&!$&&(M||3!==te||W(!0),K(!0),ne(te+1));var re=function(e){var a,r,c;return l.a.async((function(o){for(;;)switch(o.prev=o.next){case 0:return a="black"===k?"white":"black",S(u.token),r={board:e,turn:a,blackscore:v("black",e).length,whitescore:v("white",e).length},o.prev=3,o.next=6,l.a.awrap(I(t.id,r));case 6:c=o.sent,j(c.board),P(c.blackscore),F(c.whitescore),n.emit("play",c),o.next=16;break;case 13:o.prev=13,o.t0=o.catch(3),console.log("error.data",o.t0.data);case 16:case"end":return o.stop()}}),null,null,[[3,13]])},ce=function(e,t){var n=Object(m.a)(g);(function(e,t,n,a){var r="black"===n?"white":"black",c=[a[e][t]];return h.map((function(o){try{var u=o(e,t,a),l=[u];if(u&&u.state===r){for(;u&&u.state===r;)u=o(u.rowIndex,u.columnIndex,a),l.push(u);u&&u.state===n&&(c=c.concat(l))}}catch(i){}})),c.map((function(e){return e.state=n,e})),c})(e,t,k,n).map((function(e){n[e.rowIndex][e.columnIndex]=e})),E(n).map((function(e){n[e.rowIndex][e.columnIndex]=e})),re(n)};return r.a.createElement("main",null,M?L===z?r.a.createElement("h3",{className:"reversi-board"},"ex-aequo, no winner!"):L>z?r.a.createElement("h3",{className:"reversi-board"},"Black player won!"):r.a.createElement("h3",{className:"reversi-board"},"White player won!"):r.a.createElement("h3",{className:"reversi-board"},"it's ",k," turn to play"),r.a.createElement("h3",{className:"reversi-board"},"Black score: ",L," | White score: ",z),Y?function(e){return r.a.createElement("div",{className:"alert alert-primary",role:"alert"},e," ",r.a.createElement("svg",{onClick:function(){return Z(!1)},className:"bi bi-x-square",width:"1em",height:"1em",viewBox:"0 0 20 20",fill:"currentColor",xmlns:"http://www.w3.org/2000/svg"},r.a.createElement("path",{fillRule:"evenodd",d:"M16 3H4a1 1 0 00-1 1v12a1 1 0 001 1h12a1 1 0 001-1V4a1 1 0 00-1-1zM4 2a2 2 0 00-2 2v12a2 2 0 002 2h12a2 2 0 002-2V4a2 2 0 00-2-2H4z",clipRule:"evenodd"}),r.a.createElement("path",{fillRule:"evenodd",d:"M9.293 10L6.646 7.354l.708-.708L10 9.293l2.646-2.647.708.708L10.707 10l2.647 2.646-.708.708L10 10.707l-2.646 2.647-.708-.707L9.293 10z",clipRule:"evenodd"})))}(Y):null,r.a.createElement("article",{className:"reversi-board"},r.a.createElement("button",{onClick:function(){return function(){var e,a;return l.a.async((function(r){for(;;)switch(r.prev=r.next){case 0:return e={board:b(),active:!0,turn:"black"},S(u.token),j(b()),W(!1),r.next=6,l.a.awrap(I(t.id,e));case 6:a=r.sent,n.emit("play",a);case 8:case"end":return r.stop()}}))}()}},"Reset Game"),g.map((function(e){return r.a.createElement("div",{key:g.indexOf(e)},e.map((function(e){return r.a.createElement(R,Object.assign({key:e.name},e,{handlePlayTurn:ce}))})))})),r.a.createElement("div",{className:"player-names"},r.a.createElement("p",null,t&&t.users[0]?t.users[0].username:"En attende du joueur"),r.a.createElement("button",{onClick:function(){return function(){K(!1);var e=Object(m.a)(g);E(e).map((function(t){e[t.rowIndex][t.columnIndex]=t})),re(e)}()}},"Passer le tour"),r.a.createElement("p",null,t&&t.users[1]?t.users[1].username:"En attende du joueur"))))},P=function(e){var t=e.handleGameCreation,n=e.changeName,c=e.changePassword,o=e.handleLogin,u=e.handleRegister,l=e.loggedUser,i=e.allBoards,s=e.handleJoinGame,m=e.changeBoardName;return l?r.a.createElement("div",{style:{textAlign:"center",margin:"30vh auto",width:"70%"}},r.a.createElement("h1",{role:"welcome"},"Bienvenue ",l.username," !"),r.a.createElement("input",{type:"text",placeholder:"Nom de la partie",onChange:m}),r.a.createElement("button",{onClick:function(){return t()}},"Cr\xe9er une partie"),function(){var e=i.filter((function(e){return e.active}));return e.map((function(e){return r.a.createElement("p",{key:e.id},e.name,r.a.createElement("button",{onClick:function(){return s(e.id)}},"Rejoindre la partie"))}))}()):r.a.createElement(a.Fragment,null,r.a.createElement("h1",null,"React Reversi Game"),r.a.createElement("form",{onSubmit:u},r.a.createElement("div",null,r.a.createElement("input",{type:"text",onChange:n})),r.a.createElement("div",null,r.a.createElement("input",{type:"password",onChange:c})),r.a.createElement("button",{type:"submit"},"Cr\xe9er un compte")),r.a.createElement(r.a.Fragment,null,r.a.createElement("h2",null,"Connexion"),r.a.createElement("form",{onSubmit:o},r.a.createElement("div",null,r.a.createElement("label",{htmlFor:"username"},"Pseudonyme"),r.a.createElement("input",{type:"text",name:"username",title:"Pseudonyme",onChange:n})),r.a.createElement("div",null,r.a.createElement("label",{htmlFor:"password"},"Mot de passe"),r.a.createElement("input",{type:"password",name:"password",title:"Password",onChange:c})),r.a.createElement("button",{type:"submit"},"login"))))},G=n(52),J=n.n(G),z=function(e){var t;return l.a.async((function(n){for(;;)switch(n.prev=n.next){case 0:return n.next=2,l.a.awrap(j.a.post("http://localhost:5000/api/login",e));case 2:return t=n.sent,n.abrupt("return",t.data);case 4:case"end":return n.stop()}}))},F=n(53),T=n(10),A=function(){var e=Object(a.useState)(!1),t=Object(i.a)(e,2),n=t[0],c=t[1],o=Object(a.useState)([]),u=Object(i.a)(o,2),s=u[0],m=u[1],d=Object(a.useState)(""),f=Object(i.a)(d,2),p=f[0],h=f[1],v=Object(a.useState)(""),w=Object(i.a)(v,2),E=w[0],g=w[1],j=Object(a.useState)(""),O=Object(i.a)(j,2),x=O[0],I=O[1],N=Object(a.useState)(""),R=Object(i.a)(N,2),G=R[0],A=R[1],M=Object(a.useState)([]),W=Object(i.a)(M,2),D=W[0],H=W[1],q=Object(a.useState)(J()("http://localhost:5000")),U=Object(i.a)(q,1)[0];Object(a.useEffect)((function(){y().then((function(e){return m(e)})),h(JSON.parse(localStorage.getItem("user")))}),[]);var V=function(e){e.preventDefault(),C({username:E,password:G}),g(""),A("")},$=function(e){var t;return l.a.async((function(n){for(;;)switch(n.prev=n.next){case 0:return e.preventDefault(),n.next=3,l.a.awrap(z({username:E,password:G}));case 3:t=n.sent,localStorage.setItem("user",JSON.stringify(t)),h(t),setTimeout((function(){g(""),A("")}),200);case 7:case"end":return n.stop()}}))},K=function(){var e;return l.a.async((function(t){for(;;)switch(t.prev=t.next){case 0:return S(p.token),t.next=3,l.a.awrap(k({board:b(),name:x}));case 3:e=t.sent,H(e),m(s.concat(e)),setTimeout((function(){c(!0)}),500);case 7:case"end":return t.stop()}}))},Q=function(e){var t;return l.a.async((function(n){for(;;)switch(n.prev=n.next){case 0:B(p.id,{board:e}),t=s.find((function(t){return t.id===e})),H(t),setTimeout((function(){c(!0)}),500);case 4:case"end":return n.stop()}}))};return r.a.createElement(F.a,null,r.a.createElement("div",null,n?r.a.createElement(T.a,{to:"game/".concat(D.id)}):null,r.a.createElement(T.b,{exact:!0,path:"/",render:function(){return r.a.createElement(P,{handleRegister:V,handleLogin:$,handleGameCreation:K,loggedUser:p,allBoards:s,changeBoardName:function(e){var t=e.target;return I(t.value)},changeName:function(e){var t=e.target;return g(t.value)},handleJoinGame:Q,changePassword:function(e){var t=e.target;return A(t.value)}})}}),r.a.createElement(T.b,{exact:!0,path:"/game/:id",render:function(e){var t,n=e.match;return r.a.createElement(L,{board:(t=n.params.id,s.find((function(e){return e.id===t}))),socket:U})}})))};Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));o.a.render(r.a.createElement(A,null),document.getElementById("root")),"serviceWorker"in navigator&&navigator.serviceWorker.ready.then((function(e){e.unregister()}))},56:function(e,t,n){e.exports=n(114)},61:function(e,t,n){}},[[56,1,2]]]);
//# sourceMappingURL=main.210427a0.chunk.js.map
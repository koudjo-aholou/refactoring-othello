(this.webpackJsonpclient=this.webpackJsonpclient||[]).push([[0],{107:function(e,t){},114:function(e,t,n){"use strict";n.r(t);var a=n(0),r=n.n(a),c=n(52),o=n.n(c),u=(n(61),n(3)),i=n.n(u),l=n(2),s=n(16),m=n(17),d={state:"empty"},f=["A","B","C","D","E","F","G","H"],p=[0,1,2,3,4,5,6,7],b=function(){var e=p.map((function(e){return p.map((function(t){return Object(s.a)({},d,{rowIndex:e,columnIndex:t,name:f[e]+(t+1)})}))}));return e[3][3].state="white",e[3][4].state="black",e[4][3].state="black",e[4][4].state="white",e[3][2].state="playable",e[2][3].state="playable",e[4][5].state="playable",e[5][4].state="playable",e},h=[function(e,t,n){return n[e-1][t-1]},function(e,t,n){return n[e+1][t-1]},function(e,t,n){return n[e-1][t+1]},function(e,t,n){return n[e+1][t+1]},function(e,t,n){return n[e][t+1]},function(e,t,n){return n[e][t-1]},function(e,t,n){return n[e-1][t]},function(e,t,n){return n[e+1][t]}],v=function(e,t){var n=[];return t.map((function(t){return t.map((function(t){return t.state===e?n.push(t):null}))})),n},g=function(e,t){var n=[];return v("black"===e?"white":"black",t).map((function(n){return function(e,t,n){var a=e.rowIndex,r=e.columnIndex,c=[];return h.map((function(e){try{var o=e(a,r,n);if(o&&o.state===t){for(;o&&o.state===t;)o=e(o.rowIndex,o.columnIndex,n);o&&"empty"===o.state&&c.push(o)}}catch(u){}})),c}(n,e,t)})).map((function(e){return e.map((function(e){return n.push(e)}))})),n.map((function(e){return e.state="playable",e}))},w=function(e){return v("playable",e).map((function(e){return e.state="empty",e}))},E=n(6),O=n.n(E),x="http://localhost:9000/api/boards",y=null,j=function(){var e;return i.a.async((function(t){for(;;)switch(t.prev=t.next){case 0:return e=O.a.get(x),t.abrupt("return",e.then((function(e){return e.data})));case 2:case"end":return t.stop()}}))},k=function(e){var t={headers:{Authorization:y}};return console.log("newObject",e),O.a.post(x,e,t).then((function(e){return e.data}))},I=function(e,t){var n={headers:{Authorization:y}};return O.a.put("".concat(x,"/").concat(e),t,n).then((function(e){return e.data}))},S=function(e){y="bearer ".concat(e)},C=function(e){return"playable"===e.state?r.a.createElement("div",{className:"reversi-tile"},r.a.createElement("div",{className:e.state,name:e.name,onClick:function(){return e.handleTileChange(e.rowIndex,e.columnIndex)}})):r.a.createElement("div",{className:"reversi-tile"},r.a.createElement("div",{className:e.state,name:e.name}))},N=n(26),B=n.n(N),G=function(e){var t=e.board,n=Object(a.useState)(""),c=Object(l.a)(n,2),o=c[0],u=c[1],d=Object(a.useState)([]),f=Object(l.a)(d,2),p=f[0],E=f[1],O=Object(a.useState)(""),x=Object(l.a)(O,2),y=x[0],k=x[1],N=Object(a.useState)(v("black",p).length),G=Object(l.a)(N,2),J=G[0],F=G[1],P=Object(a.useState)(v("white",p).length),R=Object(l.a)(P,2),T=R[0],A=R[1],W=Object(a.useState)(!1),D=Object(l.a)(W,2),z=D[0],L=D[1],U=Object(a.useState)([]),q=Object(l.a)(U,2),H=(q[0],q[1]),M=Object(a.useState)(!1),$=Object(l.a)(M,2),K=$[0],Q=$[1],V=Object(a.useState)(0),X=Object(l.a)(V,2),Y=X[0],Z=X[1],_=B()("http://localhost:9000");Object(a.useEffect)((function(){j().then((function(e){if(console.log("board",t),t){var n=e.find((function(e){return e.id===t.id}));k(n.turn),E(n.board),H(n.users),F(n.blackscore),A(n.whitescore)}})),u(JSON.parse(localStorage.getItem("user"))),_.on("coucou",(function(e){console.log("data",e)})),_.on("play",(function(e){E(e.board),F(e.blackscore),A(e.whitescore),k(e.turn)}))}),[t,B.a]);if(z){var ee=Object(m.a)(p);w(ee).map((function(e){ee[e.rowIndex][e.columnIndex]=e})),I(t.id,Object(s.a)({},p,{board:ee,active:!1}))}v("playable",p)&&!K&&(z||3!==Y||L(!0),Q(!0),Z(Y+1));var te=function(e){var n,a,r,c;return i.a.async((function(u){for(;;)switch(u.prev=u.next){case 0:return k(n="black"===y?"white":"black"),S(o.token),a={board:e,turn:n,blackscore:v("black",e).length,whitescore:v("white",e).length},u.prev=4,u.next=7,i.a.awrap(I(t.id,a));case 7:r=u.sent,E(r.board),F(r.blackscore),A(r.whitescore),_.emit("play",r),u.next=17;break;case 14:u.prev=14,u.t0=u.catch(4),console.log("error.data",u.t0.data);case 17:return u.next=19,i.a.awrap(I(t.id,a));case 19:c=u.sent,E(c.board),_.emit("play",c);case 22:case"end":return u.stop()}}),null,null,[[4,14]])},ne=function(e,t){var n=Object(m.a)(p);if(function(e,t,n,a){var r="black"===n?"white":"black",c=[a[e][t]];return h.map((function(o){try{var u=o(e,t,a),i=[u];if(u&&u.state===r){for(;u&&u.state===r;)u=o(u.rowIndex,u.columnIndex,a),i.push(u);u&&u.state===n&&(c=c.concat(i))}}catch(l){}})),c.map((function(e){return e.state=n,e})),c}(e,t,y,n).map((function(e){n[e.rowIndex][e.columnIndex]=e})),w(n).map((function(e){n[e.rowIndex][e.columnIndex]=e})),g(y,n).map((function(e){n[e.rowIndex][e.columnIndex]=e})),v("empty",n).length+v("playable",n).length<1)return Q(!1),L(!0);te(n)};return r.a.createElement(r.a.Fragment,null,z?J===T?r.a.createElement("h3",{className:"reversi-board"},"ex-aequo, no winner!"):J>T?r.a.createElement("h3",{className:"reversi-board"},"Black player won!"):r.a.createElement("h3",{className:"reversi-board"},"White player won!"):r.a.createElement("h3",{className:"reversi-board"},"it's ",y," turn to play"),r.a.createElement("h3",{className:"reversi-board"},"Black score: ",J," | White score: ",T),r.a.createElement("button",{onClick:function(){return function(){var e={board:b(),active:!0,turn:"black"};S(o.token),E(b()),k("black"),L(!1),I(t.id,e)}()}},"Reset Game"),r.a.createElement("article",{className:"reversi-board"},p.map((function(e){return r.a.createElement("div",{key:p.indexOf(e)},e.map((function(e){return r.a.createElement(C,Object.assign({key:e.name},e,{handleTileChange:ne}))})))}))),K?r.a.createElement("button",{onClick:function(){return function(){Q(!1);var e=Object(m.a)(p);w(e).map((function(t){e[t.rowIndex][t.columnIndex]=t})),g(y,e).map((function(t){e[t.rowIndex][t.columnIndex]=t})),te(e)}()}},"Passer le tour"):null)},J=function(e){var t=e.handleGameCreation,n=e.changeName,c=e.changePassword,o=e.handleLogin,u=e.handleRegister,i=e.loggedUser,l=e.allBoards,s=e.handleJoinGame,m=e.changeBoardName;return i?r.a.createElement("div",{style:{textAlign:"center",margin:"30vh auto",width:"70%"}},r.a.createElement("h1",{role:"welcome"},"Bienvenue ",i.username," !"),r.a.createElement("input",{type:"text",placeholder:"Nom de la partie",onChange:m}),r.a.createElement("button",{onClick:function(){return t()}},"Cr\xe9er une partie"),function(){var e=l.filter((function(e){return e.active}));return e.map((function(e){return r.a.createElement("p",{key:e.id},e.name,r.a.createElement("button",{onClick:function(){return s(e.id)}},"Rejoindre la partie"))}))}()):r.a.createElement(a.Fragment,null,r.a.createElement("h1",null,"React Reversi Game"),r.a.createElement("form",{onSubmit:u},r.a.createElement("div",null,r.a.createElement("input",{type:"text",onChange:n})),r.a.createElement("div",null,r.a.createElement("input",{type:"password",onChange:c})),r.a.createElement("button",{type:"submit"},"Cr\xe9er un compte")),r.a.createElement(r.a.Fragment,null,r.a.createElement("h2",null,"Connexion"),r.a.createElement("form",{onSubmit:o},r.a.createElement("div",null,r.a.createElement("label",{htmlFor:"username"},"Pseudonyme"),r.a.createElement("input",{type:"text",name:"username",title:"Pseudonyme",onChange:n})),r.a.createElement("div",null,r.a.createElement("label",{htmlFor:"password"},"Mot de passe"),r.a.createElement("input",{type:"password",name:"password",title:"Password",onChange:c})),r.a.createElement("button",{type:"submit"},"login"))))},F="http://localhost:9000/api/users",P=function(e){return O.a.post(F,e).then((function(e){return e.data}))},R=function(e,t){return O.a.put("".concat(F,"/").concat(e),t).then((function(e){return e.data}))},T=function(e){var t;return i.a.async((function(n){for(;;)switch(n.prev=n.next){case 0:return n.next=2,i.a.awrap(O.a.post("http://localhost:9000/api/login",e));case 2:return t=n.sent,n.abrupt("return",t.data);case 4:case"end":return n.stop()}}))},A=n(53),W=n(10),D=function(){var e=Object(a.useState)(!1),t=Object(l.a)(e,2),n=t[0],c=t[1],o=Object(a.useState)([]),u=Object(l.a)(o,2),s=u[0],m=u[1],d=Object(a.useState)(""),f=Object(l.a)(d,2),p=f[0],h=f[1],v=Object(a.useState)(""),g=Object(l.a)(v,2),w=g[0],E=g[1],O=Object(a.useState)(""),x=Object(l.a)(O,2),y=x[0],I=x[1],C=Object(a.useState)(""),N=Object(l.a)(C,2),B=N[0],F=N[1],D=Object(a.useState)([]),z=Object(l.a)(D,2),L=z[0],U=z[1];Object(a.useEffect)((function(){j().then((function(e){return m(e)})),h(JSON.parse(localStorage.getItem("user")))}),[]);var q=function(e){return s.find((function(t){return t.id===e}))},H=function(e){e.preventDefault(),P({username:w,password:B}),E(""),F("")},M=function(e){var t;return i.a.async((function(n){for(;;)switch(n.prev=n.next){case 0:return e.preventDefault(),n.next=3,i.a.awrap(T({username:w,password:B}));case 3:t=n.sent,localStorage.setItem("user",JSON.stringify(t)),h(t),setTimeout((function(){E(""),F("")}),200);case 7:case"end":return n.stop()}}))},$=function(){var e;return i.a.async((function(t){for(;;)switch(t.prev=t.next){case 0:return S(p.token),t.next=3,i.a.awrap(k({board:b(),name:y}));case 3:e=t.sent,U(e),m(s.concat(e)),setTimeout((function(){c(!0)}),500);case 7:case"end":return t.stop()}}))},K=function(e){var t;return i.a.async((function(n){for(;;)switch(n.prev=n.next){case 0:R(p.id,{board:e}),t=s.find((function(t){return t.id===e})),U(t),setTimeout((function(){c(!0)}),500);case 4:case"end":return n.stop()}}))};return r.a.createElement(A.a,null,r.a.createElement("div",null,n?r.a.createElement(W.a,{to:"game/".concat(L.id)}):null,r.a.createElement(W.b,{exact:!0,path:"/",render:function(){return r.a.createElement(J,{handleRegister:H,handleLogin:M,handleGameCreation:$,loggedUser:p,allBoards:s,changeBoardName:function(e){var t=e.target;return I(t.value)},changeName:function(e){var t=e.target;return E(t.value)},handleJoinGame:K,changePassword:function(e){var t=e.target;return F(t.value)}})}}),r.a.createElement(W.b,{exact:!0,path:"/game/:id",render:function(e){var t=e.match;return console.log("boardById",q(t.params.id)),r.a.createElement(G,{board:q(t.params.id)})}})))};Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));o.a.render(r.a.createElement(D,null),document.getElementById("root")),"serviceWorker"in navigator&&navigator.serviceWorker.ready.then((function(e){e.unregister()}))},56:function(e,t,n){e.exports=n(114)},61:function(e,t,n){}},[[56,1,2]]]);
//# sourceMappingURL=main.8509da46.chunk.js.map